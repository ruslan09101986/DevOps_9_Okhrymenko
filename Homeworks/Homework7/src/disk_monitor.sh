#!/bin/bash

# Отримання порогового значення, яке передається як параметр.
# Якщо параметр не задано, використовується значення за замовчуванням 80.
THRESHOLD=${1:-80}

# Отримання поточного використання дискового простору для розділу '/'
# Використовуємо команду df, щоб витягти значення з другого рядка та прибрати символ '%'.
DISK_USAGE=$(df / | awk 'NR==2 {gsub(/%/,""); print $5}')

# Перевірка: якщо поточне використання більше порогу, формуємо повідомлення та записуємо в лог.
if [ "$DISK_USAGE" -gt "$THRESHOLD" ]; then
    TIMESTAMP=$(date '+%Y-%m-%d %H:%M:%S')
    LOG_MESSAGE="$TIMESTAMP : Попередження: Використання диску на розділі / становить ${DISK_USAGE}%, що перевищує встановлений поріг ${THRESHOLD}%."
    echo "$LOG_MESSAGE" >> /var/log/disk.log
fi

